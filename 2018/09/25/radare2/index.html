<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    
    <title>Radare2 | Room of Requirement | pwn what you want</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="pwn,tech">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/third-party/swipebox.min.css?v=1.3.2">
    <link rel="stylesheet" href="/css/style.css?v=1.3.2">
    
    <script type="text/javascript">
        // Data Center
        var DC = {
            reward:	true,
            lv: JSON.parse('{"enable":false,"app_id":null,"app_key":null,"icon":true}'),
            v: JSON.parse('{"enable":false,"appid":null,"appkey":null,"notify":true,"verify":true,"placeholder":"give me some sugers plz...","avatar":"wavatar"}'),
            g: JSON.parse('{"enable":false,"lazy":true,"owner":"siriuswhiter","repo":"gitment","oauth":{"client_id":null,"client_secret":null},"perPage":10}'),
            d: JSON.parse('{"app_id":null}')
        };
    </script>
    <script type="text/javascript">
        window.lazyScripts=[];
    </script>
    
</head>


<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      
      <img src="/img/brand.jpg" class="brand-bg">
      
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Sirius Whiter</h5>
          <a href="mailto:xuewenjie2017@outlook.com" title="xuewenjie2017@outlook.com" class="mail">
            
              <span>x</span>
            
              <span>u</span>
            
              <span>e</span>
            
              <span>w</span>
            
              <span>e</span>
            
              <span>n</span>
            
              <span>j</span>
            
              <span>i</span>
            
              <span>e</span>
            
              <span>2</span>
            
              <span>0</span>
            
              <span>1</span>
            
              <span>7</span>
            
              <span>@</span>
            
              <span>o</span>
            
              <span>u</span>
            
              <span>t</span>
            
              <span>l</span>
            
              <span>o</span>
            
              <span>o</span>
            
              <span>k</span>
            
              <span>.</span>
            
              <span>c</span>
            
              <span>o</span>
            
              <span>m</span>
            
          </a>
        </hgroup>
        
        <ul class="menu-link">
          
              <li>
                <a href="https://github.com/siriuswhiter" target="_blank">
                  <i class="icon icon-lg icon-github"></i>
                </a>
              </li>
            
        </ul>
        
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                HOME
              </a>
            </li>
        
            <li class="">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                CATEGORIES
              </a>
            </li>
        
            <li class="">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                TAGS
              </a>
            </li>
        
            <li class="">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                ARCHIVES
              </a>
            </li>
        
            <li class="">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                ABOUT
              </a>
            </li>
        
            <li class="">
              <a href="https://github.com/siriuswhiter" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        
	
<header class="top-header" id="header">
    <div class="flex-row clearfix">
        <a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">
            <span>Radare2</span>
            
        </div>
        
        <a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light">
            <i class="icon icon-lg icon-search"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">
    <img src="/img/banner.jpg" class="header-bg">
    <div class="container fade-scale">
        <h1 class="title">Radare2</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-09-25T02:56:08.000Z" itemprop="datePublished" class="page-time">
  2018-09-25
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/pwn/">pwn</a></li></ul>

            
        </h5>
        
    </div>
    

</header>

<div id="site_search">
    <div class="search-title clearfix">
        <span class="pull-left">
          <i class="icon icon-lg icon-search"></i>
        </span>
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search my blog..." class="form-control pull-left"/>
        <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light">
          <i class="icon icon-lg icon-close"></i>
        </a>
    </div>
    <div id="local-search-result"></div>
</div>




<div class="container body-wrap">
    <article id="post-radare2"
  class="post-article article-type-post" itemprop="blogPost">
    <div class="post-card">
        <h1 class="post-card-title">Radare2</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-09-25 10:56:08" datetime="2018-09-25T02:56:08.000Z"  itemprop="datePublished">2018-09-25</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/pwn/">pwn</a></li></ul>



            

            


            
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            
            <p><em>之前听闻学长说许多大佬都用这个工具？(雾；就没事来瞎搞一搞这个可以用来逆向或pwn的神器？感觉还是很帅的hhhh，就是用起来有点emmm</em></p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>git clone r2仓库即可，尽量每天使用前 ./sys/install.sh 更新一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/radare/radare2.git</span><br><span class="line">$ cd radare2</span><br><span class="line">$ ./sys/install.sh</span><br></pre></td></tr></table></figure>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p><em>之后学习使用中逐渐更新</em><br>常用包含工具：</p>
<ul>
<li>radare2-&gt;整合了所有工具</li>
<li>rabin2-&gt;查看文件格式的</li>
<li>radiff2-&gt;比较文件不同的</li>
<li>rahash2-&gt;各种密码算法，hash算法集成</li>
<li>rasm2-&gt;汇编和反汇编</li>
<li>ragg2-&gt;开发shellcode工具(radare2自己编写的编译器)</li>
</ul>
<h3 id="radare2"><a href="#radare2" class="headerlink" title="radare2"></a>radare2</h3><pre><code>随便加载个文件,会有一句欢迎语hhhh
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$r2 pwnme</span><br><span class="line"> -- We only have bugs, features are an unintended side-effect</span><br><span class="line">[0x08049090]&gt;                  //工具找到的入口位置</span><br></pre></td></tr></table></figure>
<h3 id="rabin2"><a href="#rabin2" class="headerlink" title="rabin2"></a>rabin2</h3><pre><code>查看文件基本信息
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># rabin2 -I pwnme</span><br><span class="line">arch     x86</span><br><span class="line">baddr    0x8048000</span><br><span class="line">binsz    14275</span><br><span class="line">bintype  elf</span><br><span class="line">bits     32</span><br><span class="line">canary   false</span><br><span class="line">sanitiz  false</span><br><span class="line">class    ELF32</span><br><span class="line">crypto   false</span><br><span class="line">endian   little</span><br><span class="line">havecode true</span><br><span class="line">intrp    /lib/ld-linux.so.2</span><br><span class="line">lang     c</span><br><span class="line">linenum  true</span><br><span class="line">lsyms    true</span><br><span class="line">machine  Intel 80386</span><br><span class="line">maxopsz  16</span><br><span class="line">minopsz  1</span><br><span class="line">nx       true</span><br><span class="line">os       linux</span><br><span class="line">pcalign  0</span><br><span class="line">pic      false</span><br><span class="line">relocs   true</span><br><span class="line">relro    partial</span><br><span class="line">rpath    NONE</span><br><span class="line">static   false</span><br><span class="line">stripped false</span><br><span class="line">subsys   linux</span><br><span class="line">va       true</span><br></pre></td></tr></table></figure>
<h3 id="rahash2"><a href="#rahash2" class="headerlink" title="rahash2"></a>rahash2</h3><pre><code>支持超多加解密
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"># rahash2 -L    //列举</span><br><span class="line">Available Hashes: </span><br><span class="line">h  md5</span><br><span class="line">h  sha1</span><br><span class="line">h  sha256</span><br><span class="line">h  sha384</span><br><span class="line">h  sha512</span><br><span class="line">h  md4</span><br><span class="line">h  xor</span><br><span class="line">h  xorpair</span><br><span class="line">h  parity</span><br><span class="line">h  entropy</span><br><span class="line">h  hamdist</span><br><span class="line">h  pcprint</span><br><span class="line">h  mod255</span><br><span class="line">h  xxhash</span><br><span class="line">h  adler32</span><br><span class="line">h  luhn</span><br><span class="line">h  crc8smbus</span><br><span class="line">h  crc15can</span><br><span class="line">h  crc16</span><br><span class="line">h  crc16hdlc</span><br><span class="line">h  crc16usb</span><br><span class="line">h  crc16citt</span><br><span class="line">h  crc24</span><br><span class="line">h  crc32</span><br><span class="line">h  crc32c</span><br><span class="line">h  crc32ecma267</span><br><span class="line">h  crc32bzip2</span><br><span class="line">h  crc32d</span><br><span class="line">h  crc32mpeg2</span><br><span class="line">h  crc32posix</span><br><span class="line">h  crc32q</span><br><span class="line">h  crc32jamcrc</span><br><span class="line">h  crc32xfer</span><br><span class="line">h  crc64</span><br><span class="line">h  crc64ecma</span><br><span class="line">h  crc64we</span><br><span class="line">h  crc64xz</span><br><span class="line">h  crc64iso</span><br><span class="line"></span><br><span class="line">Available Encoders/Decoders: </span><br><span class="line">e  base64</span><br><span class="line">e  base91</span><br><span class="line">e  punycode</span><br><span class="line"></span><br><span class="line">Available Crypto Algos: </span><br><span class="line">c  rc2</span><br><span class="line">c  rc4</span><br><span class="line">c  rc6</span><br><span class="line">c  aes-ecb</span><br><span class="line">c  aes-cbc</span><br><span class="line">c  ror</span><br><span class="line">c  rol</span><br><span class="line">c  rot</span><br><span class="line">c  blowfish</span><br><span class="line">c  cps2</span><br><span class="line">c  des-ecb</span><br><span class="line">c  xor</span><br><span class="line">c  serpent-ecb</span><br><span class="line"></span><br><span class="line"># rahash2 -a md5 ./pwnme       //生成md5哈希</span><br><span class="line">./pwnme: 0x00000000-0x00003c73 md5: 2569b37607fc52065f5b4e7c349d0e56</span><br></pre></td></tr></table></figure>
<h3 id="rasm2"><a href="#rasm2" class="headerlink" title="rasm2"></a>rasm2</h3><pre><code>支持汇编反汇编 
</code></pre><h3 id="ragg2"><a href="#ragg2" class="headerlink" title="ragg2"></a>ragg2</h3><pre><code>据说可以用来快速开发shellcode？
</code></pre><h3 id="radiff2"><a href="#radiff2" class="headerlink" title="radiff2"></a>radiff2</h3><pre><code>支持二进制文件的字节级或增量差异对比，查找基本代码块中的更改。
厂商更新漏洞时，可以寻找更新代码字段，说不定在那里还有希望挖到其他洞
</code></pre><h3 id="rafind2"><a href="#rafind2" class="headerlink" title="rafind2"></a>rafind2</h3><pre><code>在文件中查找字节模式
</code></pre><h3 id="rarun2"><a href="#rarun2" class="headerlink" title="rarun2"></a>rarun2</h3><pre><code>用于在不同环境中运行程序的启动器，具有不同的参数，权限，目录和
覆盖的默认文件描述符。
rarun2可用于：
* 破解小程序
* 模糊测试
* 测试组件
</code></pre><h3 id="rax2"><a href="#rax2" class="headerlink" title="rax2"></a>rax2</h3><pre><code>用于shell的简约数学表达式求值器，用于在浮点值，十六进制表示，
十六进制字符串到ASCII之间进行基本转换，八进制到整数等。
它还支持字节顺序设置，如果没有参数，可以用作交互式shell 给出。
</code></pre><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><ul>
<li>i 开头的命令主要是用来获取各种信息。iz – 列出数据段里的字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[0x08049090]&gt; ie</span><br><span class="line">[Entrypoints]</span><br><span class="line">vaddr=0x08049090 paddr=0x00001090 baddr=0x08048000 laddr=0x00000000 haddr=0x00000018 type=program</span><br><span class="line"></span><br><span class="line">1 entrypoints</span><br><span class="line"></span><br><span class="line">[0x08049090]&gt; iz</span><br><span class="line">[Strings]</span><br><span class="line">Num Vaddr      Paddr      Len Size Section  Type  String</span><br><span class="line">000 0x00002008 0x0804a008   7   8 (.rodata) ascii /bin/sh</span><br><span class="line">001 0x00002010 0x0804a010   5   6 (.rodata) ascii input</span><br></pre></td></tr></table></figure>
<ul>
<li>a 开头的命令主要是用来分析文件。radare2 不会主动去分析一个文件，因为这样做的代价太大了，它需要花费很多的时间。也可以在运行 radare2的使用 -A 参数来直接分析一个文件(例如 r2 -A pwnme)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># r2 -A pwnme</span><br><span class="line">[x] Analyze all flags starting with sym. and entry0 (aa)</span><br><span class="line">[x] Analyze function calls (aac)</span><br><span class="line">[x] Analyze len bytes of instructions for references (aar)</span><br><span class="line">[x] Constructing a function name for fcn.* and sym.func.* functions (aan)</span><br><span class="line">[x] Type matching analysis for all functions (afta)</span><br><span class="line">[x] Use -AA or aaaa to perform additional experimental analysis.</span><br><span class="line"> -- r2OS r2pad 0.1 SMP GENERIC r2_64 GNU/r2OS</span><br></pre></td></tr></table></figure>
<ul>
<li>fs 分析完成之后， r2会将所有有用的信息和特定的名字绑定在一起，比如区段、函数、符号、字符串，这些都被称作 ‘flags’, flags 被整合进 <flag spaces="">，一个 flag 是所有类似特征的集合。可以使用 ‘fs <flagspaces>‘ 加 ‘f’ 来打印出 这个 flags 下面包含的信息，使用分号来间隔多条命令(‘cmd1;cmd2;cmd3;…’).</flagspaces></flag></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[0x08049090]&gt; fs</span><br><span class="line">0    2 * strings</span><br><span class="line">1   37 * symbols</span><br><span class="line">2   30 * sections</span><br><span class="line">3   12 * segments</span><br><span class="line">4    5 * relocs</span><br><span class="line">5    5 * imports</span><br><span class="line">6    2 * functions</span><br><span class="line">[0x08049090]&gt; fs strings;f</span><br><span class="line">0x0804a008 8 str.bin_sh</span><br><span class="line">0x0804a010 6 str.input</span><br></pre></td></tr></table></figure>
<ul>
<li><p>axt 命令用来在 data/code段里找寻某个地址相关的引用（更多的操作，请看 ‘ax?’）.‘@@’就像一个迭代器，用来在地址空间里不断地匹配后面一系列相关的命令（更多操作，请看 ‘@@?’）， ‘str.*’ 是一个通配符，用来标记所有以 ‘str.’开头的信息，这个不光会列出字符串标志，同时也包括函数名，找到它们到底在哪里以及何处被调用。</p>
</li>
<li><p>vv 大概是会显示函数列表和入口处的函数？可以查看各个函数(花里胡哨的，很漂亮哦，不如我们。。)</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-[ functions ]----------------- pdf ---</span><br><span class="line">(a) add     (x) xrefs  (q) quit  (jk) next/prev                         ;-- section..text:</span><br><span class="line">(r) rename  (c) calls  (g) go    (tab) column                           ;-- eip:</span><br><span class="line">(d) delete  (v) vars   (?) help  (:)  enter cmd             / (fcn) entry0 50</span><br><span class="line">&gt;* 0x08049090   50 entry0                                   |   entry0 ();</span><br><span class="line">   0x080490c3    4 fcn.080490c3                             |           0x08049090      xor ebp, ebp                               ; [14] -r-x secti</span><br><span class="line">   0x08049070    6 sym.imp.__libc_start_main                |           0x08049092      pop esi</span><br><span class="line">   0x080490f0   40 sym.deregister_tm_clones                 |           0x08049093      mov ecx, esp</span><br><span class="line">   0x08049130   53 sym.register_tm_clones                   |           0x08049095      and esp, 0xfffffff0</span><br><span class="line">   0x08049170   30 sym.__do_global_dtors_aux                |           0x08049098      push eax</span><br><span class="line">   0x080491a0    2 entry1.init                              |           0x08049099      push esp</span><br><span class="line">   0x080492b0    2 sym.__libc_csu_fini                      |           0x0804909a      push edx</span><br><span class="line">   0x080490e0    4 sym.__x86.get_pc_thunk.bx                |           0x0804909b      call fcn.080490c3</span><br><span class="line">   0x080492b4   20 sym._fini                                |           0x080490a0      add ebx, 0x2f60                            ; &apos;`/&apos;</span><br><span class="line">   0x08049250   93 sym.__libc_csu_init                      |           0x080490a6      lea eax, [ebx - 0x2d50]</span><br><span class="line">   0x080490d0    2 sym._dl_relocate_static_pie              |           0x080490ac      push eax                                   ; func fini</span><br><span class="line">   0x08049203   65 sym.main                                 |           0x080490ad      lea eax, [ebx - 0x2db0]</span><br><span class="line">   0x08049244    4 sym.__x86.get_pc_thunk.ax                |           0x080490b3      push eax                                   ; func init</span><br><span class="line">   0x08049050    6 sym.imp.puts                             |           0x080490b4      push ecx                                   ; char **ubp_av</span><br><span class="line">   0x080491cd   54 sym.vulnerable                           |           0x080490b5      push esi                                   ; int argc</span><br><span class="line">   0x08049040    6 sym.imp.gets                             |           0x080490b6      mov eax, sym.main                          ; 0x8049203</span><br><span class="line">   0x080491a2   43 sym.flag                                 |           0x080490bc      push eax                                   ; func main</span><br><span class="line">   0x08049060    6 sym.imp.system                           \           0x080490bd      call sym.imp.__libc_start_main             ; int __libc_star</span><br><span class="line">   0x08049000   35 sym._init</span><br><span class="line">   0x08049080    6 sub.__gmon_start_80</span><br></pre></td></tr></table></figure>
<ul>
<li>s 命令可以跳转到某个地址或者已经有了符号的函 数中去。然后我们使用pdf这个命令可以打印main这个函数的汇编代码。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[0x08049090]&gt; s main</span><br><span class="line">[0x08049203]&gt; pdf</span><br><span class="line">            ;-- main:</span><br><span class="line">/ (fcn) sym.main 65</span><br><span class="line">|   sym.main (int argc, char **argv, char **envp);</span><br><span class="line">|           ; var int local_8h @ ebp-0x8</span><br><span class="line">|           ; arg int arg_4h @ esp+0x4</span><br><span class="line">|           ; DATA XREF from entry0 (0x80490b6)</span><br><span class="line">|           0x08049203      8d4c2404       lea ecx, [arg_4h]           ; 4</span><br><span class="line">|           0x08049207      83e4f0         and esp, 0xfffffff0</span><br><span class="line">|           0x0804920a      ff71fc         push dword [ecx - 4]</span><br><span class="line">|           0x0804920d      55             push ebp</span><br><span class="line">|           0x0804920e      89e5           mov ebp, esp</span><br><span class="line">|           0x08049210      53             push ebx</span><br><span class="line">|           0x08049211      51             push ecx</span><br><span class="line">|           0x08049212      e82d000000     call sym.__x86.get_pc_thunk.ax</span><br><span class="line">|           0x08049217      05e92d0000     add eax, 0x2de9</span><br><span class="line">|           0x0804921c      83ec0c         sub esp, 0xc</span><br><span class="line">|           0x0804921f      8d9010e0ffff   lea edx, [eax - 0x1ff0]</span><br><span class="line">|           0x08049225      52             push edx                    ; const char *s</span><br><span class="line">|           0x08049226      89c3           mov ebx, eax</span><br><span class="line">|           0x08049228      e823feffff     call sym.imp.puts           ; int puts(const char *s)</span><br><span class="line">|           0x0804922d      83c410         add esp, 0x10</span><br><span class="line">|           0x08049230      e898ffffff     call sym.vulnerable</span><br><span class="line">|           0x08049235      b800000000     mov eax, 0</span><br><span class="line">|           0x0804923a      8d65f8         lea esp, [local_8h]</span><br><span class="line">|           0x0804923d      59             pop ecx</span><br><span class="line">|           0x0804923e      5b             pop ebx</span><br><span class="line">|           0x0804923f      5d             pop ebp</span><br><span class="line">|           0x08049240      8d61fc         lea esp, [ecx - 4]</span><br><span class="line">\           0x08049243      c3             ret</span><br></pre></td></tr></table></figure>
<p>radare2还实现了IDA的类似F5功能，我们可以使用pdc命令来实现。(目前看上去真不怎么样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[0x08049203]&gt; pdc</span><br><span class="line">function sym.main () &#123;</span><br><span class="line">    //  1 basic blocks</span><br><span class="line"></span><br><span class="line">    loc_0x8049203:</span><br><span class="line"></span><br><span class="line">  //DATA XREF from entry0 (0x80490b6)</span><br><span class="line">       ecx = [arg_4h]           //4</span><br><span class="line">       esp &amp;= 0xfffffff0        //ebp</span><br><span class="line">       push dword [ecx - 4]</span><br><span class="line">       push ebp</span><br><span class="line">       ebp = esp</span><br><span class="line">       push ebx</span><br><span class="line">       push ecx</span><br><span class="line">       sym.__x86.get_pc_thunk.ax ()</span><br><span class="line">       eax += 0x2de9            //obj._GLOBAL_OFFSET_TABLE</span><br><span class="line">       esp -= 0xc</span><br><span class="line">       edx = [eax - 0x1ff0]     //&quot;input&quot; str.input</span><br><span class="line">       push edx                 //const char *s ; (pstr 0x0804a010) &quot;input&quot;</span><br><span class="line">       ebx = eax                //obj._GLOBAL_OFFSET_TABLE</span><br><span class="line">       </span><br><span class="line">       int puts(const char * s : (*0x804a010)0x00177fe0 = input)</span><br><span class="line">       esp += 0x10</span><br><span class="line">       sym.vulnerable ()</span><br><span class="line">       eax = 0</span><br><span class="line">       esp = [local_8h]</span><br><span class="line">       pop ecx</span><br><span class="line">       pop ebx</span><br><span class="line">                                //ebp</span><br><span class="line">       esp = [ecx - 4]          //ebp</span><br><span class="line">       return</span><br><span class="line">(break)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还有框架结构界面，我们可以使用大写的VV命令来到框架结构界面。(很赞</p>
<pre><code>.---------------------------------------------------.     
| [0x8049203]                                       |     
| ;-- main:                                         |     
| ;-- eip:                                          |     
| (fcn) sym.main 65                                 |     
|   sym.main (int argc, char **argv, char **envp);  |     
| ; var int local_8h @ ebp-0x8                      |     
| ; arg int arg_4h @ esp+0x4                        |     
| ; DATA XREF from entry0 (0x80490b6)               |     
| ; 4     |     
| lea ecx, [arg_4h]                                 |     
| and esp, 0xfffffff0                               |     
| push dword [ecx - 4]                              |     
| push ebp                                          |     
| mov ebp, esp                                      |     
| push ebx                                          |     
| push ecx                                          |     
| call sym.__x86.get_pc_thunk.ax;[ga]               |     
| add eax, 0x2de9                                   |     
| sub esp, 0xc                                      |     
| lea edx, [eax - 0x1ff0]                           |     
| ; const char *s                                   |     
| push edx                                          |     
| mov ebx, eax                                      |     
| ; int puts(const char *s)                         |     
| call sym.imp.puts;[gb]                            |     
| add esp, 0x10                                     |     
| call sym.vulnerable;[gc]                          |     
| mov eax, 0                                        |     
| lea esp, [local_8h]                               |  
`---------------------------------------------------&apos;                                          
</code></pre><p><em>目前就了解了这一点，参考了一些大佬的文章，之后可以尝试着去使用，仅仅局限于IDA,GDB是不行的。就这样。</em></p>

        </div>
        
<blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2019-02-15T04:58:55.616Z" itemprop="dateUpdated">2019-02-15 12:58:55</time>
</span><br>


        
        转载注明出处，原文地址：<a href="/2018/09/25/radare2/" target="_blank" rel="external">http://siriuswhiter.tk/2018/09/25/radare2/</a>
        
    </div>
    <footer>
        <a href="http://siriuswhiter.tk">
            <img src="/img/avatar.jpg" alt="Sirius Whiter">
            Sirius Whiter
        </a>
    </footer>
</blockquote>

        
            <div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>

            
        
        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pwn/">pwn</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tech/">tech</a></li></ul>

            <div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://siriuswhiter.tk/2018/09/25/radare2/&title=《Radare2》 — Room of Requirement&pic=http://siriuswhiter.tk/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://siriuswhiter.tk/2018/09/25/radare2/&title=《Radare2》 — Room of Requirement&source=pwn菜鸡一枚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>

        </div>
        
            


        
    </div>
    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="prev">
      <a href="/2018/10/08/diary-20181008/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Diary.20181008</h4>
      </a>
    </div>
  

  
    <div class="next">
      <a href="/2018/09/13/jarvis-oj-pwn/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Jarvis OJ-pwn</h4>
      </a>
    </div>
  
</nav>


    
    
        <aside class="post-widget">
            <nav class="post-toc-wrap" id="post-toc">
                <strong>目录</strong>
                <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#安装"><span class="post-toc-number">1.</span> <span class="post-toc-text">安装</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#使用"><span class="post-toc-number">2.</span> <span class="post-toc-text">使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#radare2"><span class="post-toc-number">2.0.1.</span> <span class="post-toc-text">radare2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rabin2"><span class="post-toc-number">2.0.2.</span> <span class="post-toc-text">rabin2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rahash2"><span class="post-toc-number">2.0.3.</span> <span class="post-toc-text">rahash2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rasm2"><span class="post-toc-number">2.0.4.</span> <span class="post-toc-text">rasm2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ragg2"><span class="post-toc-number">2.0.5.</span> <span class="post-toc-text">ragg2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#radiff2"><span class="post-toc-number">2.0.6.</span> <span class="post-toc-text">radiff2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rafind2"><span class="post-toc-number">2.0.7.</span> <span class="post-toc-text">rafind2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rarun2"><span class="post-toc-number">2.0.8.</span> <span class="post-toc-text">rarun2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#rax2"><span class="post-toc-number">2.0.9.</span> <span class="post-toc-text">rax2</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#常用命令"><span class="post-toc-number">3.</span> <span class="post-toc-text">常用命令</span></a></li></ol>
            </nav>
            <div class="toc-bar"><div>
        </aside>
    
</article>

    <div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        请我喝奶茶呀
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/reward-wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/reward-wechat.jpg" data-alipay="/img/reward-alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>

    
</div>

        <footer class="footer">
    
    <div class="top">
        
    </div>
    
    <div class="bottom">
        <p>
            <span>
                Sirius Whiter &copy; 2018 - 2019
            </span>
        		
           	
            
            
            <span>
	            Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/codefine/hexo-theme-mellow" target="_blank">mellow</a>
            </span>
            
            
            

            
                
<span class="site-uv" title="总访客量">
    <i class="icon icon-user"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_uv"></i>
</span>


<span class="site-pv" title="总访问量">
    <i class="icon icon-eye"></i>
    <i class="busuanzi-value" id="busuanzi_value_site_pv"></i>
</span>

            
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://siriuswhiter.tk/2018/09/25/radare2/&title=《Radare2》 — Room of Requirement&pic=http://siriuswhiter.tk/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://siriuswhiter.tk/2018/09/25/radare2/&title=《Radare2》 — Room of Requirement&source=pwn菜鸡一枚" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByUlEQVR42u3aQY7CMAwF0N7/0h1pdiOgfNtNQKOXFYJAXllYiX+OIx7n77j+9HEk848VAxcXd8w9L8ec+/j61ZzosXFxcTdyr4tXXnom3KiA4uLifhn3unjlGyNcXNz/xM2XnxQ7XFzc7+EmB5jrcpbMTL5121kNFxd3wK02TFe8XtjfxcXFLXLP4sjLUNIQKa+Oi4u7hXvd8sgPOfkjVTc9Ud6Li4u7gJsfWiZbn96f8uY/xsXFXcDNC00SqFRn5q2QPzsyXFzcxdzeAr3GaD4/imdwcXGXcatHjvxaVR7KFn4HFxd3I7e35KS9kqckzZtiuLi4A25v+fxCVV6wbkiJcXFxb+JO4tVJAJO3SJ50cXBxcRdze9uLakmqFjVcXNzPcqtNzzyazR+10ITFxcXdws1vZ/QC0d5h6c37uLi4i7k94r2Ba6G04eLibuRWw5UJpde0xcXF3c+ttk2rIUpe2ppJLC4u7q3cSeB6VxBbLZq4uLh7uNUNyqTZkRSyN2UUFxd3I7cae8zbqQu3L7i4uBu5k6NOb0v0ZF1cXNyv506aLHmUgouL+ynu5Ieq4Wt1J9M8q+Hi4g64ky9PLl3NW664uLgLuD8y33adBxhglAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>


    
    <!-- main-js -->
<script type="text/javascript" src="//cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
<script type="text/javascript" src="/js/plugins/fastclick.js?v=1.3.2"></script>
<script type="text/javascript" src="/js/plugins/ios-orientationchange-fix.js?v=1.3.2"></script>
<script type="text/javascript" src="/js/plugins/jquery.swipebox.min.js?v=1.3.2"></script>
<script type="text/javascript" color="255,0,0"opacity="0.3"count="70" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

<script type="text/javascript" src="https://cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<script type="text/javascript" src="/js/method.js?v=1.3.2"></script>
<script type="text/javascript" src="/js/blog.js?v=1.3.2"></script>

<!-- third-party -->
<script type="text/javascript">
;( function( $ ) {

	$( '.swipebox' ).swipebox({
		hideCloseButtonOnMobile: true
	});

} )( jQuery );
</script>






<script type="text/javascript" src="/js/plugins/local_search.js?v=1.3.2"></script>
<script type="text/javascript">
	var search_path = "search.xml";
	if (search_path.length === 0) {
		search_path = "search.xml";
	}
	var path = "/" + search_path;
	searchFunc(path, "local-search-input", "local-search-result");
</script>



<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    





    <!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>






    
</body>
</html>
